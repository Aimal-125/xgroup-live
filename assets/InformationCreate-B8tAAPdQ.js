import{r as c,a as U,b as q,A as w,_ as D,j as e,c as N}from"./index-B7EDHShO.js";import{u as C}from"./useQuery-BH2ipur7.js";import{F as S,a as A}from"./formik.esm-DEzKEWAH.js";import{F as l}from"./FormControl-DgOezG3Z.js";import{c as T}from"./informationActions-zGdWQBK3.js";import{L as B}from"./LoadingBtn-DmYHjot9.js";import{c as V,a as i}from"./index.esm-DElqZkcs.js";import{B as L}from"./BackBtn-CSTzC4ci.js";import{H as E}from"./Heading-DW26iUKW.js";import"./Input-Dl_zu7N-.js";import"./react-tooltip.min-CfVVvbF_.js";import"./index-LvzHWtTh.js";import"./index-Chjiymov.js";import"./ClipLoader-DJNL0iZY.js";const z=({createInformationloading:n,faqcategories:o})=>{const[d,p]=c.useState(!1),[h,x]=c.useState(""),[j,f]=c.useState(""),m=U(),b=q(),I=V({categoryTitle:i().required("Category is required"),question:i().required("Title is required"),answer:i().required("Description is required"),attachmentDataURI:i().required("Attacment  is required"),featuredImageDataURI:i().required("FeatureImage is required")}),v={categoryTitle:"",question:"",answer:"",attachmentDataURI:"",featuredImageDataURI:""},{data:u}=C({queryKey:["fetch-all-faqcategoris"],queryFn:()=>w.get("/faq/categories")}),y=async t=>{console.log(t);try{const a=await g(t.attachmentDataURI),r=await g(t.featuredImageDataURI),s={...t,attachmentDataURI:a||j,featuredImageDataURI:r};m(T(s)),b("/app/Information")}catch(a){console.error("Error creating information:",a)}},g=t=>new Promise((a,r)=>{if(t){const s=new FileReader;s.readAsDataURL(t),s.onload=()=>a(s.result),s.onerror=F=>r(F)}else a(null)});c.useEffect(()=>{if(u){const{data:{data:{doc:t}}}=u;m(D(t))}},[u,m]);const R=t=>{const a=t.target.files[0],r=new FileReader,s=5*1024*1024;if(a&&a.type.startsWith("video/")){if(a.size>s)return alert("Max video size is 5mb");x(URL.createObjectURL(a)),r.readAsDataURL(a),r.addEventListener("load",()=>{f(r.result)})}};return e.jsx("div",{className:"bg-dark p-4 rounded-lg mt-6 pb-6",children:e.jsx(S,{initialValues:v,validationSchema:I,onSubmit:y,children:t=>e.jsxs(A,{className:"bg-dark rounded-lg p-4 flex flex-col gap-4 pb-6",children:[e.jsxs("div",{className:"form-row",children:[e.jsx("label",{children:"Question Category"}),e.jsxs("select",{name:"categoryTitle",value:t.values.categoryTitle,onChange:t.handleChange,onBlur:t.handleBlur,children:[e.jsx("option",{value:"",disabled:!0,children:"Select a category"}),o==null?void 0:o.map((a,r)=>e.jsx("option",{value:a,children:a},r))]}),t.errors.categoryTitle&&t.touched.categoryTitle&&e.jsx("p",{className:"text-red-500",children:t.errors.categoryTitle})]}),e.jsx(l,{control:"input",label:"Title",placeholder:"Enter Information Title",name:"question",formik:t}),e.jsx(l,{control:"textarea",label:"Description",placeholder:"Write Information Description",name:"answer",formik:t}),d?e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsx("label",{className:"font-bold",htmlFor:"videoAttachment",children:"Video Attachment"}),e.jsx("input",{type:"file",accept:"video/*",onChange:R,name:"videoAttachment",id:"videoAttachment"}),h&&e.jsx("div",{className:"w-[300px] h-[300px] max-[600px]:w-full ",children:e.jsxs("video",{controls:!0,style:{width:"100%",height:"100%",display:"block",objectFit:"cover"},children:[e.jsx("source",{src:h}),"Your browser does not support the video tag."]})}),e.jsx("button",{className:"btn-primary py-2 px-2",onClick:()=>{p(!1),x("")},children:"Cancel"})]}):e.jsx(l,{control:"image",label:"Attachment",name:"attachmentDataURI",formik:t,setVideo:p}),e.jsx(l,{control:"image",label:"Feature Image",name:"featuredImageDataURI",formik:t}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"submit",className:"btn-primary py-2 px-12",disabled:n||t.isSubmitting,children:n?e.jsx(B,{}):"Add"})})]})})})},k=()=>{const{createInformationloading:n,faqcategories:o}=N(d=>d.information);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{title:"Create New Information"}),e.jsx(L,{})]}),e.jsx(z,{createInformationloading:n,faqcategories:o})]})};export{k as default};
