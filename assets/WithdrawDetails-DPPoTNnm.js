import{u as $,r as f,j as s,A as D,k as y,L as C}from"./index-B7EDHShO.js";import{F as I,a as R}from"./formik.esm-DEzKEWAH.js";import{c as q,a as S,e as E}from"./index.esm-DElqZkcs.js";import{F as A}from"./FormControl-DgOezG3Z.js";import{d as T}from"./deposits.constants-BksPp1tF.js";import{S as k}from"./Status-CY8HG0JN.js";import{f as N}from"./formatAmount-CWLewUcu.js";import{P as F}from"./plus-icon-Cm0htiCt.js";import{h as L}from"./moment-C5S46NFB.js";import{u as P}from"./useQuery-BH2ipur7.js";import{L as B}from"./useWindowSize-DFtMrG7S.js";import{D as H}from"./DisplayError-DJ1Lcd3h.js";import{I as M}from"./ItemNotFound-DyPlXfej.js";import{B as U}from"./BackBtn-CSTzC4ci.js";import{H as Y}from"./Heading-DW26iUKW.js";import"./Input-Dl_zu7N-.js";import"./react-tooltip.min-CfVVvbF_.js";import"./index-LvzHWtTh.js";import"./index-Chjiymov.js";import"./LoadingBtn-DmYHjot9.js";import"./ClipLoader-DJNL0iZY.js";const O=q().shape({status:S().oneOf(["Pending","Approved","Declined"],"Invalid status").required("Status is required."),transferAmount:E().positive("Amount must be positive.").required("Amount is required."),description:S()}),V=()=>{const{id:i}=$(),[e,n]=f.useState([]),[g,j]=f.useState(!1);f.useEffect(()=>{(async()=>{var o,d,m,c;try{const{data:t}=await D.get(`/withdraw/${i}`),{data:{doc:x}}=t;n(x),j(!1)}catch(t){y.error((d=(o=t==null?void 0:t.response)==null?void 0:o.data)!=null&&d.message?(c=(m=t==null?void 0:t.response)==null?void 0:m.data)==null?void 0:c.message:t!=null&&t.message?t==null?void 0:t.message:"An error occured")}})()},[i,g]);const p={status:(e==null?void 0:e.status)||"",transferAmount:((e==null?void 0:e.amountReceived)/100).toFixed(2)||0,description:(e==null?void 0:e.description)||""},v=async(l,{setSubmitting:o,resetForm:d})=>{var m,c,t,x,h;o(!0);try{const{transferAmount:a,description:w,...b}=l,{data:u}=await D.patch(`/withdraw/${i}`,b);u!=null&&u.success&&(y.success((m=u==null?void 0:u.data)==null?void 0:m.message),j(!0))}catch(a){y.error((t=(c=a==null?void 0:a.response)==null?void 0:c.data)!=null&&t.message?(h=(x=a==null?void 0:a.response)==null?void 0:x.data)==null?void 0:h.message:a!=null&&a.message?a==null?void 0:a.message:"An error occured while submitting form")}finally{o(!1),d()}};return s.jsx("div",{children:s.jsx(I,{initialValues:p,validationSchema:O,onSubmit:v,enableReinitialize:!0,children:l=>s.jsxs(R,{autoComplete:"off",className:"flex flex-col gap-4",children:[s.jsx(A,{control:"select",label:"Status",name:"status",options:T,formik:l}),s.jsx(A,{control:"input",type:"number",label:`Amount To Transfer ${e!=null&&e.currencyCode?`(${e==null?void 0:e.currencyCode})`:""}`,name:"transferAmount",formik:l,disabled:!0}),s.jsx(A,{control:"textarea",label:"Description",placeholder:"Write here...",name:"description",formik:l,maxLength:100}),s.jsx("div",{className:"mt-6 flex items-end justify-end",children:s.jsx("button",{type:"submit",className:"btn-primary py-2 px-12",disabled:l.isSubmitting,children:"Save"})})]})})})},r=({label:i,value:e,to:n})=>s.jsxs("div",{className:"flex items-center justify-between gap-4 last-of-type:border-none border-b border-b-gray-700 p-4",children:[s.jsx("h6",{children:i}),n?s.jsx(C,{to:n,className:"text-grayText underline",children:e}):s.jsx("div",{className:"text-grayText",children:e})]}),W=({label:i,value:e,icon:n})=>s.jsxs("div",{className:"flex items-center justify-between gap-4 border-b border-b-gray-700 p-4",children:[s.jsx("h6",{children:i}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{children:s.jsx("img",{src:n,alt:"plus icon"})}),s.jsx("span",{children:e})]})]}),_=()=>{var l,o,d,m,c,t,x,h,a,w,b;const{id:i}=$(),[e,n]=f.useState([]),g=["fetch-UserWithdrawalsDetails",{id:i}],{isLoading:j,data:p,isError:v}=P({queryKey:g,queryFn:()=>D.get(`/withdraw/${i}`)});return f.useEffect(()=>{if(p){const{data:{data:{doc:u}}}=p;n(u)}},[p]),s.jsx(s.Fragment,{children:j?s.jsx("div",{className:"p-5",children:s.jsx(B,{})}):v?s.jsx("div",{className:"p-5",children:s.jsx(H,{message:"An error occured while fetching data"})}):((l=Object.keys(e))==null?void 0:l.length)===0?s.jsx("div",{className:"p-5",children:s.jsx(M,{message:"No data found."})}):s.jsxs("div",{children:[s.jsx(r,{label:"Full Name",value:((o=e==null?void 0:e.user)==null?void 0:o.fullName)||"N/A"}),s.jsx(r,{label:"Username",value:(d=e==null?void 0:e.user)==null?void 0:d.username,to:`/app/users/details/${(m=e==null?void 0:e.user)==null?void 0:m._id}`}),s.jsx(r,{label:"Email",value:(c=e==null?void 0:e.user)==null?void 0:c.email}),s.jsx(r,{label:"Phone",value:(t=e==null?void 0:e.user)==null?void 0:t.phone}),s.jsx(W,{label:"Withdraw Coins",value:N(e==null?void 0:e.coinsToWithdraw),icon:F}),s.jsx(W,{label:"Service Charges",value:N((e==null?void 0:e.serviceCharges)+"%"),icon:F}),s.jsx(r,{label:"Received Amount",value:`${e==null?void 0:e.currencyCode} ${N(((e==null?void 0:e.amountReceived)/100||0).toFixed(2))}`}),s.jsx(r,{label:"Withdraw Wallet",value:(x=e==null?void 0:e.wallet)==null?void 0:x.type.replace("_"," ")}),s.jsx(r,{label:"Withdraw By",value:(h=e==null?void 0:e.withdrawAccountDetails)==null?void 0:h.withdrawPaymentMethod}),s.jsx(r,{label:"Account Holder",value:(a=e==null?void 0:e.withdrawAccountDetails)==null?void 0:a.accountHolderTitle}),s.jsx(r,{label:"Account Number",value:(w=e==null?void 0:e.withdrawAccountDetails)==null?void 0:w.accountNumber}),s.jsx(r,{label:"Date & Time",value:L((b=e==null?void 0:e.withdrawAccountDetails)==null?void 0:b.createdAt).format("DD MMM YYYY hh:mm A")}),s.jsx(r,{label:"Status",value:s.jsx(k,{status:e==null?void 0:e.status})})]})})},pe=()=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Y,{title:"Withdraw Details"}),s.jsx(U,{})]}),s.jsxs("div",{className:"flex lg:gap-6 gap-4 lg:flex-row flex-col mt-6",children:[s.jsx("div",{className:"lg:flex-[0.7] bg-dark rounded-lg",children:s.jsx(_,{})}),s.jsx("div",{className:"flex-[0.3] h-fit bg-dark p-4 rounded-lg flex flex-col gap04",children:s.jsx(V,{})})]})]});export{pe as default};
