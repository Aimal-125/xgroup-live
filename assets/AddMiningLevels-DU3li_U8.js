import{r as t,k as l,H as x,j as e,A as p}from"./index-Dgq3PrwZ.js";import{F as ee,a as se,b as m,E as u}from"./formik.esm-C3G25gt-.js";import{B as re}from"./BackBtn-BTtbY5T6.js";import{H as te}from"./Heading-BleAqs7B.js";import{c as A,e as f}from"./index.esm-D8Mb4-8M.js";import{T as ae,a as ne,b as k,c,d as oe,e as d}from"./Tr-92nl9wdn.js";import{h as le}from"./moment-C5S46NFB.js";import{P as ie}from"./index-k2bY_Rk7.js";import{P as ce}from"./plus-icon-Cm0htiCt.js";import{c as de}from"./confirmBox-CwIKJADo.js";import{u as xe}from"./useQuery-DVR9z6m7.js";import{L as pe}from"./useWindowSize-IxhlW9ZK.js";import{D as me}from"./DisplayError-DbAkVp0H.js";import{I as ue}from"./ItemNotFound-jt-aLSPW.js";import"./index-Chjiymov.js";import"./LoadingBtn-ean50z1k.js";import"./ClipLoader-DZl_46q6.js";function Fe(){const[i,T]=t.useState([]),[h,R]=t.useState(1),[Y,B]=t.useState(1),M=10,[$,b]=t.useState(""),[H,g]=t.useState(""),[V,v]=t.useState(""),[_,j]=t.useState(""),[z,y]=t.useState(!0),[E,C]=t.useState(!1),[S,K]=t.useState(""),[D,I]=t.useState(!1),[L,F]=t.useState(!1),{isLoading:Q,data:N,isError:U,error:w}=xe({queryKey:["fetch-minings",{currentPage:h,limit:M,dataAdded:E,updated:D,docDeleted:L}],queryFn:()=>p.get(`/mining-level?page=${h}&pageSize=${M}&sortBy=createdAt_ascending`)});t.useEffect(()=>{if(N){const{data:{data:{docs:s,pages:n}}}=N;T(s),B(n),C(!1),I(!1),F(!1)}w&&l.error(x(w))},[N,w,E,D,L]);const W=A().shape({interval:f().typeError("Must be a number").required("Required"),coinsAwardAfterEveryInterval:f().typeError("Must be a number").required("Required"),option1:A().shape({depositCoins:f().typeError("Must be a number").required("Required")}),option2:A().shape({downLineActiveMembers:f().typeError("Must be a number").required("Required")})}),G={interval:V,coinsAwardAfterEveryInterval:_,option1:{depositCoins:$},option2:{downLineActiveMembers:H}},J=async(s,{resetForm:n})=>{var o,a;if(z)try{const{data:r}=await p.post("/mining-level",s);r!=null&&r.success&&(C(!0),l.success((o=r==null?void 0:r.data)==null?void 0:o.message))}catch(r){l.error(x(r))}finally{n()}else try{if(S){const{data:r}=await p.patch(`/mining-level/${S}`,s);r!=null&&r.success&&(I(!0),l.success((a=r==null?void 0:r.data)==null?void 0:a.message))}}catch(r){l.error(x(r))}finally{y(!0),b(""),g(""),v(""),j(""),n()}},O=(s,n,o,a,r)=>{b(n),g(o),v(a),j(r),y(!1),K(s)},X=s=>{de({message:"Are you sure? You want to delete this document?",onYesClick:async()=>{var a;try{const{data:r}=await p.delete(`/mining-level/${s}`);r!=null&&r.success&&(F(!0),l.success((a=r==null?void 0:r.data)==null?void 0:a.message))}catch(r){l.error(x(r))}}})},Z=s=>{y(!0),b(""),g(""),v(""),j(""),s.resetForm()};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(te,{title:"Add Mining Levels"}),e.jsx(re,{})]}),e.jsx("div",{className:"mt-5",children:e.jsx(ee,{validationSchema:W,initialValues:G,onSubmit:J,enableReinitialize:!0,children:s=>e.jsxs(se,{className:"flex flex-col gap-3 bg-dark p-5 rounded-md",children:[e.jsxs("div",{className:"flex gap-3 max-[600px]:flex-col",children:[e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[e.jsx("label",{className:"font-bold",htmlFor:"option1.depositCoins",children:"Deposit Coins"}),e.jsx(m,{className:"bg-inherit px-4 py-2 border border-gray-700 rounded outline-none focus:border-blue-500",name:"option1.depositCoins",id:"option1.depositCoins",form:s}),e.jsx(u,{name:"option1.depositCoins",component:"div",className:"text-sm text-red-500"})]}),e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[e.jsx("label",{className:"font-bold",htmlFor:"option2.downLineActiveMembers",children:"Downline Active Members"}),e.jsx(m,{className:"bg-inherit px-4 py-2 border border-gray-700 rounded outline-none focus:border-blue-500",name:"option2.downLineActiveMembers",id:"option2.downLineActiveMembers",form:s}),e.jsx(u,{name:"option2.downLineActiveMembers",component:"div",className:"text-sm text-red-500"})]})]}),e.jsxs("div",{className:"flex gap-3 max-[600px]:flex-col",children:[e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[e.jsx("label",{className:"font-bold",htmlFor:"interval",children:"Mining Cycle (Hours)"}),e.jsx(m,{className:"bg-inherit px-4 py-2 border border-gray-700 rounded outline-none focus:border-blue-500",name:"interval",id:"interval",form:s}),e.jsx(u,{name:"interval",component:"div",className:"text-sm text-red-500"})]}),e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[e.jsx("label",{className:"font-bold",htmlFor:"coinsAwardAfterEveryInterval",children:"Coins After Every Cycle"}),e.jsx(m,{className:"bg-inherit px-4 py-2 border border-gray-700 rounded outline-none focus:border-blue-500",name:"coinsAwardAfterEveryInterval",id:"coinsAwardAfterEveryInterval",form:s}),e.jsx(u,{name:"coinsAwardAfterEveryInterval",component:"div",className:"text-sm text-red-500"})]})]}),e.jsxs("div",{className:"flex max-[340px]:flex-col justify-center items-center gap-5 mt-2",children:[e.jsx("div",{className:"max-[600px]:w-full",children:e.jsx("button",{type:"button",className:"bg-gray-700 hover:bg-gray-600 rounded-md px-10 py-2 max-[600px]:w-full",onClick:()=>Z(s),children:"Reset"})}),e.jsx("div",{className:"max-[600px]:w-full",children:e.jsx("button",{type:"submit",className:"btn-primary px-10 py-2 max-[600px]:w-full",disabled:s.isSubmitting,children:"Submit"})})]})]})})}),e.jsx("section",{children:Q?e.jsx(pe,{}):U?e.jsx(me,{}):(i==null?void 0:i.length)===0?e.jsx(ue,{}):e.jsx("div",{className:"bg-secondary rounded-lg p-2 overflow-x-auto mt-5",children:e.jsxs("div",{className:"bg-dark  p-2 rounded-lg overflow-container  custom-scrollbar",children:[e.jsxs(ae,{className:"sm:text-base text-sm table-auto  ",children:[e.jsx(ne,{className:"bg-secondary text-left rounded-lg",children:e.jsxs(k,{children:[e.jsx(c,{scope:"col",className:" font-medium px-6 py-4 text-center",children:"Level #"}),e.jsx(c,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Deposit Coins"}),e.jsx(c,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Downline Active Members"}),e.jsx(c,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Date & Time"}),e.jsx(c,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Action"})]})}),e.jsx(oe,{children:i==null?void 0:i.map((s,n)=>{var o,a,r;return e.jsxs(k,{className:"text-grayText sm:hover:bg-stroke hover:text-pure border-b border-b-gray-700",children:[e.jsx(d,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:s==null?void 0:s.level}),e.jsx(d,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("span",{children:e.jsx("img",{src:ce,alt:"coins icon",width:"16",height:"16"})}),e.jsx("span",{children:((a=(o=s==null?void 0:s.option1)==null?void 0:o.depositCoins)==null?void 0:a.toFixed(2))||0})]})}),e.jsx(d,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:((r=s==null?void 0:s.option2)==null?void 0:r.downLineActiveMembers)||0}),e.jsx(d,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:le((s==null?void 0:s.createdAt)||"2025-01-01").format("D, MMMM YYYY, hh:mm A")}),e.jsx(d,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("button",{className:"text-green-500",title:"View",onClick:()=>{var P,q;return O(s==null?void 0:s._id,(P=s==null?void 0:s.option1)==null?void 0:P.depositCoins,(q=s==null?void 0:s.option2)==null?void 0:q.downLineActiveMembers,s==null?void 0:s.interval,s==null?void 0:s.coinsAwardAfterEveryInterval)},children:e.jsx("i",{className:"uil uil-pen text-xl"})}),e.jsx("button",{className:"text-red-500",title:"View",onClick:()=>X(s==null?void 0:s._id),children:e.jsx("i",{className:"uil uil-trash text-xl"})})]})})]},n)})})]}),e.jsx(ie,{totalPages:Y,currentPage:h,setCurrentPage:R})]})})})]})})}export{Fe as default};
