import{c as m,j as e,a as b,aj as E,ak as J,b as Y,d as z,r as f,q as M,p as L,k as _,A as H}from"./index-CR2PTnGP.js";import{H as q}from"./Heading-BGYpxq2W.js";import{B as K}from"./BackBtn-qMQnlAqP.js";import{S as R}from"./Search-DTfgO1pT.js";import{T as O,a as Q,b as k,c as p,d as V,e as x}from"./Tr-Cwkp4QFl.js";import{M as g}from"./react-tooltip.min-8-V3KYLF.js";import{I as W}from"./img1-CxsS-zk5.js";import{P as G}from"./index-JjVOQ-Uu.js";import{D as X}from"./dateFormats-DbNBvi53.js";import{d as Z,B as ee,a as se}from"./userActions-C41UPYrL.js";import{c as D}from"./confirmBox-CrYk273m.js";import{S as ae}from"./Status-QkBM8NRO.js";import{P as te}from"./plus-icon-Cm0htiCt.js";import{u as oe}from"./useQuery-BvaY5-TG.js";import{L as re}from"./useWindowSize-Do2-NPva.js";import{D as le}from"./DisplayError-DwBfIbvM.js";import{I as ne}from"./ItemNotFound-BOlywaMD.js";import"./index-LvzHWtTh.js";import"./index-Chjiymov.js";import"./LoadingBtn-BtdHQEGi.js";import"./ClipLoader-BVQCHCPU.js";function ce(t=0){const l=["","k","M","B","T"];if(t===0)return 0;if(t<1e3)return t==null?void 0:t.toFixed();if(t>=1e15)return"âˆž";const i=Math.floor(Math.log10(t)),n=Math.floor(i/3),h=l[n];return`${(t/Math.pow(10,n*3)).toFixed(1)}${h}`}const w=({title:t,amount:l=0})=>e.jsxs("div",{className:"bg-dark rounded-lg border border-gray-700 text-center p-4",children:[e.jsx("p",{className:"font-bold text-3xl text-primary",children:ce(l)}),e.jsx("h3",{className:"font-semibold mt-2",children:t})]}),ie=()=>{const{totalUsers:t,todayJoined:l,yesterdayJoined:o}=m(i=>i.user);return e.jsxs("div",{className:"mt-8 grid md:grid-cols-3 sm:grid-cols-2 grid-cols-1 gap-6",children:[e.jsx(w,{title:"Total Users",amount:t}),e.jsx(w,{title:"Today Joined",amount:l}),e.jsx(w,{title:"Yesterday Joined",amount:o})]})},de=[{label:"High Deposit",value:"-totalDepositAmount"},{label:"Low Deposit",value:"totalDepositAmount"}],pe=()=>{const t=b(),l=o=>{t(J(o))};return e.jsx("div",{className:"bg-dark p-4 rounded-lg mt-6 pb-6 ",children:e.jsxs("div",{className:"flex items-center gap-4 sm:flex-row flex-col",children:[e.jsx("div",{className:"flex-1",children:e.jsx(R,{label:"Search User",placeholder:"Username",fetcher:l,onClick:o=>o.stopPropagation()})}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{children:"Sort"}),e.jsxs("select",{onClick:o=>{o.stopPropagation()},onChange:o=>t(E(o.target.value)),children:[e.jsx("option",{value:"",children:"All"}),de.map(o=>e.jsx("option",{value:o.value,className:"capitalize",children:o.label},o.value))]})]})]})})},xe=({docs:t,pages:l,currentPage:o,setCurrentPage:i})=>{const n=Y(),h=new X,j=b(),u=(s,d)=>{s.stopPropagation(),D({message:"Are you sure? You want to delete this user?",onYesClick:()=>j(Z(d))})},y=(s,d)=>{s.stopPropagation(),D({message:"Are you sure? You want to block this user?",onYesClick:()=>j(ee(d))})};return e.jsx("div",{className:"bg-secondary rounded-lg p-2 overflow-x-auto",children:e.jsxs("div",{className:"bg-dark  p-2 rounded-lg overflow-auto  custom-scrollbar",children:[e.jsxs(O,{className:"sm:text-base text-sm table-auto  ",children:[e.jsx(Q,{className:"bg-secondary text-left rounded-lg",children:e.jsxs(k,{className:"",children:[e.jsx(p,{scope:"col",className:" font-medium px-6 py-4 text-left",children:"Username"}),e.jsx(p,{scope:"col",className:" font-medium px-6 py-4 text-center",children:"Email"}),e.jsx(p,{scope:"col",className:" font-medium px-6 py-4 text-center",children:"Phone"}),e.jsx(p,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Total Deposit (coins)"}),e.jsx(p,{scope:"col",className:" font-medium px-6 py-4 text-center",children:"Joined"}),e.jsx(p,{scope:"col",className:" font-medium px-6 py-4 text-center",children:"Status"}),e.jsx(p,{scope:"col",className:" font-medium px-6 py-4 text-center",children:"Actions"})]})}),e.jsx(V,{children:t==null?void 0:t.map((s,d)=>{var c;return e.jsxs(k,{className:"text-grayText sm:hover:bg-stroke hover:text-pure border-b border-b-gray-700",onClick:()=>n(`/app/users/details/${s==null?void 0:s._id}`),children:[e.jsx(x,{className:"flex items-center justify-center p-4",children:e.jsxs("span",{className:"inline-flex items-center justify-start gap-2 w-full",style:{wordBreak:"break-all"},children:[s!=null&&s.image?e.jsx("img",{src:`${z}/${s==null?void 0:s.image}`,alt:s==null?void 0:s.username,className:"w-8 h-8 rounded-full"}):e.jsx("img",{src:W,alt:s==null?void 0:s.username,className:"w-8 h-8 rounded-full"}),e.jsx("span",{className:"underline",children:s==null?void 0:s.username})]})}),e.jsx(x,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:s.email}),e.jsx(x,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:s.phone}),e.jsx(x,{className:"px-3 py-4 whitespace-nowrap sm:text-center",children:e.jsxs("span",{className:"inline-flex w-full items-center justify-center gap-2",children:[e.jsx("span",{children:e.jsx("img",{src:te,alt:"deposit coins",width:"16",height:"16"})}),e.jsx("span",{children:(c=s==null?void 0:s.totalDepositAmount)==null?void 0:c.toFixed()})]})}),e.jsx(x,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:h.ISO8601(s.createdAt)}),e.jsx(x,{className:"w-full px-6 py-4 inline-flex justify-center items-center relative top-[-12px] whitespace-nowrap sm:text-center",children:e.jsx(ae,{status:s==null?void 0:s.status})}),e.jsx(x,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:e.jsxs("div",{className:"flex items-center justify-center gap-4 text-xl",children:[e.jsxs("button",{onClick:r=>{r.stopPropagation(),n(`/app/users/details/${s._id}`)},className:"text-primary","data-tooltip-id":"view-user-details","data-tooltip-content":"View Details",children:[e.jsx("i",{className:"uil uil-eye"}),e.jsx(g,{id:"view-user-details",style:{fontSize:15}})]}),e.jsxs("button",{onClick:r=>{r.stopPropagation(),n(`/app/users/edit/${s==null?void 0:s._id}`)},className:"text-green-500","data-tooltip-id":"edit-user","data-tooltip-content":"Edit User",children:[e.jsx("i",{className:"uil uil-edit-alt"}),e.jsx(g,{id:"edit-user",style:{fontSize:15}})]}),e.jsxs("button",{onClick:r=>y(r,s==null?void 0:s._id),className:"text-pink-500","data-tooltip-id":"block-user","data-tooltip-content":"Block User",children:[e.jsx("i",{className:"uil uil-ban"}),e.jsx(g,{id:"block-user",style:{fontSize:15}})]}),e.jsxs("button",{onClick:r=>u(r,s==null?void 0:s._id),className:"text-red-500","data-tooltip-id":"delete-user","data-tooltip-content":"Delete User",children:[e.jsx("i",{className:"uil uil-trash"}),e.jsx(g,{id:"delete-user",style:{fontSize:15}})]})]})})]},d)})})]}),e.jsx(G,{totalPages:l,currentPage:o,setCurrentPage:i})]})})},Be=()=>{const{docs:t,pages:l}=m(a=>a==null?void 0:a.user),{keyword:o}=m(a=>a==null?void 0:a.user),{sort:i}=m(a=>a==null?void 0:a.user),n=10,{userBlocked:h}=m(a=>a==null?void 0:a.user),{userDeleted:j}=m(a=>a==null?void 0:a.user),[u,y]=f.useState(""),[s,d]=f.useState(""),c=b(),[r,S]=f.useState(1),U=["fetch-allUsers",{currentPage:r,limit:n,fromDate:u,toDate:s,keyword:o,sort:i,userBlocked:h,userDeleted:j}],{isLoading:C,data:N,isError:P,error:v}=oe({queryKey:U,queryFn:()=>H.get(`/user/users?page=${r}&pageSize=${n}&from=${u}&to=${s}&keyword=${o}&sort=${i}`)});return f.useEffect(()=>{if(N){const{data:{data:{docs:a,pages:T,docsCount:A,page:F,totalUsers:$,todayJoined:B,yesterdayJoined:I}}}=N;c(se(a,T,A,F,$,B,I)),c(M(!1)),c(L(!1))}if(v){const{response:{data:{message:a}}}=v;_.error(a)}},[c,r,N,v]),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(q,{title:"All Users"}),e.jsx(K,{})]}),e.jsxs("div",{className:"flex justify-between max-[400px]:flex-col gap-5 mt-6",children:[e.jsxs("div",{className:"form-row",children:[e.jsx("label",{htmlFor:"fromDate",children:"From Date"}),e.jsx("input",{type:"date",id:"fromDate",placeholder:u?"":"Select Date",onChange:a=>y(a.target.value),value:u})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{htmlFor:"toDate",children:"To Date"}),e.jsx("input",{type:"date",id:"toDate",placeholder:s?"":"Select Date",onChange:a=>d(a.target.value),value:s})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx(ie,{}),e.jsx(pe,{}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"heading-sm mb-3",children:"Users"}),e.jsx("div",{children:C?e.jsx(re,{}):P?e.jsx(le,{message:"An error occurred while fetching users."}):(t==null?void 0:t.length)===0?e.jsx(ne,{message:"No data found"}):e.jsx(xe,{docs:t,pages:l,currentPage:r,setCurrentPage:S})})]})]})]})};export{Be as default};
