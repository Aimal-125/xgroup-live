import{j as e,d as H,L as D,a8 as E,c as I,a as L,r as n,A as P}from"./index-B7EDHShO.js";import{T as B,a as M,b,c,d as $,e as l}from"./Tr-CFhT2wbf.js";import{M as C}from"./react-tooltip.min-CfVVvbF_.js";import{P as Y}from"./index-CqrQsClu.js";import{I as z}from"./img1-CxsS-zk5.js";import{h as w}from"./moment-C5S46NFB.js";import{H as R}from"./Heading-DW26iUKW.js";import{B as U}from"./BackBtn-CSTzC4ci.js";import{L as Z}from"./useWindowSize-DFtMrG7S.js";import{u as _}from"./useQuery-BH2ipur7.js";import{D as q}from"./DisplayError-DJ1Lcd3h.js";import{I as W}from"./ItemNotFound-DyPlXfej.js";import"./index-LvzHWtTh.js";import"./LoadingBtn-DmYHjot9.js";import"./ClipLoader-DJNL0iZY.js";const K=({docs:t,pages:f,currentPage:d,setCurrentPage:a})=>e.jsx("div",{className:"bg-secondary rounded-lg p-2 overflow-x-auto",children:e.jsxs("div",{className:"bg-dark  p-2 rounded-lg overflow-container  custom-scrollbar",children:[e.jsxs(B,{className:"sm:text-base text-sm table-auto  ",children:[e.jsx(M,{className:"bg-secondary text-left rounded-lg",children:e.jsxs(b,{children:[e.jsx(c,{scope:"col",className:" font-medium px-6 py-4 text-center",children:"Sr"}),e.jsx(c,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"User"}),e.jsx(c,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"From"}),e.jsx(c,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"To"}),e.jsx(c,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Date"}),e.jsx(c,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Coins"}),e.jsx(c,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Action"})]})}),e.jsx($,{children:t==null?void 0:t.map((s,o)=>{var m,p,j,x,g,i,u,h,y;return e.jsxs(b,{className:"text-grayText sm:hover:bg-stroke hover:text-pure border-b border-b-gray-700",children:[e.jsx(l,{className:"  px-6 py-4 whitespace-nowrap sm:text-center text-right",children:s!=null&&s.longAutoIncrementId?s==null?void 0:s.longAutoIncrementId:"N/A"}),e.jsx(l,{className:"py-4 px-6",children:e.jsxs("span",{className:"inline-flex items-center justify-start gap-3 w-full h-full ",children:[(m=s==null?void 0:s.user)!=null&&m.image?e.jsx("img",{src:`${H}/${(p=s==null?void 0:s.user)==null?void 0:p.image}`,alt:(j=s==null?void 0:s.user)==null?void 0:j.username,className:"w-8 h-8 rounded-full"}):e.jsx("img",{src:z,alt:(x=s==null?void 0:s.user)==null?void 0:x.username,className:"w-8 h-8 rounded-full"}),e.jsx(D,{to:`/app/users/details/${(g=s==null?void 0:s.user)==null?void 0:g._id}`,className:"underline capitalize",children:(i=s==null?void 0:s.user)==null?void 0:i.username})]})}),e.jsx(l,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:(h=(u=s==null?void 0:s.fromWallet)==null?void 0:u.type)==null?void 0:h.replace("_"," ")}),e.jsx(l,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:e.jsx("span",{children:"Trade"})}),e.jsx(l,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:w(s==null?void 0:s.createdAt).format("YYYY-MM-DD")}),e.jsx(l,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:s!=null&&s.coinsTransferred?(y=s==null?void 0:s.coinsTransferred)==null?void 0:y.toFixed(2):"N/A"}),e.jsx(l,{className:"px-6 py-4 whitespace-nowrap sm:text-center text-center",children:e.jsxs(D,{to:`/app/transferhistory/details/${s._id}`,className:"text-primary","data-tooltip-id":"view-user-details","data-tooltip-content":"View Details",children:[e.jsx("i",{className:"uil uil-eye"}),e.jsx(C,{id:"view-user-details",style:{fontSize:15}})]})})]},o)})})]}),e.jsx(Y,{totalPages:f,currentPage:d,setCurrentPage:a})]})}),Q=(t,f)=>async d=>{try{d(E({docs:t,pages:f}))}catch(a){console.log(a)}},pe=()=>{const{docs:t,pages:f}=I(r=>r==null?void 0:r.transferHistory),d=L(),[a,s]=n.useState(""),[o,m]=n.useState(""),[p,j]=n.useState(1),[x,g]=n.useState(""),[i,u]=n.useState("");n.useEffect(()=>{if(a&&o){if(w(o).isSame(a)||w(o).isBefore(a))return u("2025-01-11T23:59:59.999Z");if(w(a).isAfter(o))return s("2025-01-11T23:59:59.999Z");g(a),u(o)}},[a,o]);const h=10,y=["fetch-allTransferHistory",{currentPage:p,limit:h,backendFromDate:x,backendToDate:i}],{isLoading:v,data:T,isError:S,error:N}=_({queryKey:y,queryFn:()=>{const r=new URLSearchParams;return r.append("page",p),r.append("pageSize",h),x&&r.append("from",x),i&&r.append("to",i),P.get(`/transfer?${r.toString()}`)}}),[A,F]=n.useState("Error");return n.useEffect(()=>{if(T){const{data:{data:{docs:r,pages:k}}}=T;d(Q(r,k))}if(N){const{response:{data:{message:r}}}=N;F(r)}},[d,T,N]),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(R,{title:"Transfer History"}),e.jsx(U,{})]}),e.jsxs("div",{className:"flex justify-between max-[400px]:flex-col gap-5 mt-6",children:[e.jsxs("div",{className:"form-row",children:[e.jsx("label",{htmlFor:"fromDate",children:"From Date"}),e.jsx("input",{type:"date",id:"fromDate",placeholder:"Select Date",onChange:r=>s(r.target.value),value:a})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{htmlFor:"toDate",children:"To Date"}),e.jsx("input",{type:"date",id:"toDate",placeholder:"Select Date",onChange:r=>m(r.target.value),value:o})]})]}),e.jsx("div",{className:"mt-6",children:v?e.jsx(Z,{}):S?e.jsx(q,{message:N?A:"An error occurred while fetching data"}):(t==null?void 0:t.length)===0?e.jsx(W,{message:"No data found."}):e.jsx(K,{docs:t,pages:f,currentPage:p,setCurrentPage:j})})]})};export{pe as default};
