import{u as K,c as F,r,j as a,A as y,k as A}from"./index-B-9Gm_Me.js";import{F as L,a as O,b as z,E as J}from"./formik.esm-BbQy4037.js";import{B as v}from"./BackBtn-uUxpUHCb.js";import{H as G}from"./Heading-CR7EINQw.js";import{F as s}from"./FormControl-CIKMnFb0.js";import{c as q,a as n,e as p,f as M}from"./index.esm-Bg4kD9Su.js";import"./Input-Be9myPu5.js";import"./react-tooltip.min-BA7Ht3Ge.js";import"./index-LvzHWtTh.js";import"./index-Chjiymov.js";function ne(){const{id:d}=K(),{imageData:x}=F(t=>t==null?void 0:t.image),[e,P]=r.useState([]),[f,R]=r.useState(""),{depositAccountType:b}=F(t=>t==null?void 0:t.depositAccounts),[m,I]=r.useState(""),[T,N]=r.useState(!1),[o,D]=r.useState(!0);r.useEffect(()=>{(e==null?void 0:e.currentlyAcceptingPayments)!==""&&D(e==null?void 0:e.currentlyAcceptingPayments)},[e==null?void 0:e.currentlyAcceptingPayments]);const[S,w]=r.useState(""),j=0+S.length;r.useEffect(()=>{const t=JSON.parse(localStorage.getItem("verificationMethod"));I(b||t)},[b]);const C={label:(e==null?void 0:e.label)||"",accountHolderTitle:(e==null?void 0:e.accountHolderTitle)||"",accountNumber:(e==null?void 0:e.accountNumber)||"",minimumDepositFiat:(e==null?void 0:e.minimumDepositFiat)*.01||"",maximumDepositFiat:(e==null?void 0:e.maximumDepositFiat)*.01||"",currencyCode:(e==null?void 0:e.currencyCode)||"",imageDataURI:"",paymentMethod:(e==null?void 0:e.paymentMethod)||"",financialInstitutionTitle:(e==null?void 0:e.financialInstitutionTitle)||"",currentlyAcceptingPayments:o?"yes":"no"},E={label:(e==null?void 0:e.label)||"",accountHolderTitle:(e==null?void 0:e.accountHolderTitle)||"",accountNumber:(e==null?void 0:e.accountNumber)||"",minimumDepositFiat:(e==null?void 0:e.minimumDepositFiat)*.01||"",maximumDepositFiat:(e==null?void 0:e.maximumDepositFiat)*.01||"",currencyCode:(e==null?void 0:e.currencyCode)||"",imageDataURI:"",paymentMethod:(e==null?void 0:e.paymentMethod)||"",financialInstitutionTitle:(e==null?void 0:e.financialInstitutionTitle)||"",currentlyAcceptingPayments:o?"yes":"no"},H=q().shape({label:n().required("Required"),accountHolderTitle:n().required("Required"),accountNumber:n().required("Required"),minimumDepositFiat:p().typeError("Must be an integer").integer("Must be an integer").required("Required"),maximumDepositFiat:p().typeError("Must be an integer").integer("Must be an integer").required("Required"),currencyCode:n().required("Required"),imageDataURI:M().required("Required"),paymentMethod:n().required("Required"),financialInstitutionTitle:n().required("Required"),currentlyAcceptingPayments:n(),reasonForNotAcceptingPayments:n()}),U=q().shape({label:n().required("Required"),accountHolderTitle:n().required("Required"),accountNumber:n().required("Required"),minimumDepositFiat:p().typeError("Must be an integer").integer("Must be an integer").required("Required"),maximumDepositFiat:p().typeError("Must be an integer").integer("Must be an integer").required("Required"),currencyCode:n().required("Required"),imageDataURI:M().required("Required"),paymentMethod:n().required("Required"),financialInstitutionTitle:n().required("Required"),currentlyAcceptingPayments:n(),reasonForNotAcceptingPayments:n()}),V=async(t,{setSubmitting:i,resetForm:c})=>{let h;try{if(i(!0),x){o?h={...t,imageDataURI:x,description:f,minimumDepositFiat:(t==null?void 0:t.minimumDepositFiat)*100,maximumDepositFiat:(t==null?void 0:t.maximumDepositFiat)*100,verificationMethod:m}:h={...t,imageDataURI:x,description:f,minimumDepositFiat:(t==null?void 0:t.minimumDepositFiat)*100,maximumDepositFiat:(t==null?void 0:t.maximumDepositFiat)*100,verificationMethod:m,reasonForNotAcceptingPayments:t==null?void 0:t.reasonForNotAcceptingPayments};const{data:l}=await y.patch(`/app-deposit-account/${d}`,h);if(l!=null&&l.success){const{data:{message:g}}=l;A.success(g),N(!0)}}}catch(l){const{response:{data:{message:g}}}=l;A.error(g)}finally{c(),i(!1)}},$=[{value:"PKR",label:"PKR"},{value:"USD",label:"USD"}],[u,B]=r.useState([]);return r.useEffect(()=>{(async()=>{const{data:i}=await y.get("/app-payment-method");if(i){const{data:{doc:c}}=i;B(c)}})()},[]),r.useEffect(()=>{(async()=>{try{const{data:i}=await y.get(`/app-deposit-account/${d}`);if(i){const{data:{doc:c}}=i;P(c),N(!1)}}catch(i){console.log(i)}})()},[d,T]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(G,{title:"Deposit Account Edit"}),a.jsx(v,{})]}),a.jsx("div",{className:"flex bg-dark rounded-lg flex-col gap-5 mt-6 p-5",children:a.jsx(L,{initialValues:m==="Auto"?C:E,validationSchema:m==="Auto"?H:U,onSubmit:V,enableReinitialize:!0,children:t=>a.jsxs(O,{className:"flex flex-col gap-5",children:[a.jsxs("div",{className:"flex flex-col gap-5",children:[a.jsxs("div",{className:"flex flex-row max-[600px]:flex-col gap-5",children:[a.jsx("div",{className:"w-full",children:a.jsx(s,{control:"input",label:"Deposit Account Name",placeholder:"Deposit Acount Name",name:"label",formik:t})}),a.jsxs("div",{className:"flex flex-col gap-[5px] w-full",children:[a.jsx("label",{className:"font-bold",htmlFor:"paymentMethod",children:"Payment Method"}),a.jsx(z,{className:`${t.errors.paymentMethod&&t.touched.paymentMethod?"border-red-500":""} bg-inherit border border-gray-700 w-full rounded-md px-[13px] py-[13px]`,as:"select",label:"Payment Method",name:"paymentMethod",options:u,formik:t,children:u==null?void 0:u.map((i,c)=>a.jsx("option",{value:i,children:i},c))}),a.jsx(J,{name:"paymentMethod",component:"div",className:"text-sm text-red-500"})]})]}),a.jsxs("div",{className:"flex flex-row max-[600px]:flex-col gap-5",children:[a.jsx(s,{control:"input",label:"Minimum Deposit",placeholder:"Minimum Deposit",name:"minimumDepositFiat",formik:t}),a.jsx(s,{control:"input",label:"Max Deposit",placeholder:"Max Deposit",name:"maximumDepositFiat",formik:t})]}),a.jsxs("div",{className:"flex flex-row max-[600px]:flex-col gap-5",children:[a.jsx(s,{control:"input",label:"Account Holder Name",placeholder:"Deposit Acount Holder Name",name:"accountHolderTitle",formik:t}),a.jsx(s,{control:"input",label:"Account Number/IBAN Number",placeholder:"Account Number/IBAN Number",name:"accountNumber",formik:t})]}),a.jsx("div",{className:"flex flex-row max-[600px]:flex-col gap-5",children:a.jsx(s,{control:"input",label:"Financial Institution",placeholder:"Financial Institution Name",name:"financialInstitutionTitle",formik:t})}),a.jsx("div",{className:"flex flex-row max-[600px]:flex-col gap-5",children:a.jsx(s,{control:"select",label:"Currency",name:"currencyCode",options:$,formik:t})}),a.jsxs("div",{className:"flex flex-col gap-5",children:[a.jsx(s,{control:"image",label:"Deposit Account Image",name:"imageDataURI",form:t,previewImg:e==null?void 0:e.image}),a.jsx(s,{control:"textarea",label:"Description",name:"description",maxLength:"100",defaultValue:e==null?void 0:e.description,form:t,setDescription:R})]}),a.jsxs("div",{className:"flex flex-col gap-5",children:[a.jsxs("div",{className:"",children:[a.jsx("input",{type:"checkbox",name:"currentlyAcceptingPayments",id:"currentlyAcceptingPayments",checked:o,onChange:()=>{D(!o)},form:t,hidden:!0}),a.jsxs("label",{htmlFor:"currentlyAcceptingPayments",className:"inline-flex max-[300px]:flex-col max-[300px]:items-start items-center gap-5 w-fit",children:[a.jsx("label",{className:"font-bold",htmlFor:"currentlyAcceptingPayments",children:"Accept Payment"}),a.jsx("span",{className:"accept-payment-toggle"})]})]}),o?"":a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsx("label",{className:"font-bold",htmlFor:"reasonForNotAcceptingPayments",children:"Payment Unacceptance Reason"}),a.jsx("textarea",{className:"bg-inherit border rounded-md border-gray-700 p-3 outline-none focus:border-blue-500",name:"reasonForNotAcceptingPayments",id:"reasonForNotAcceptingPayments",rows:"4",maxLength:"100",defaultValue:e==null?void 0:e.reasonForNotAcceptingPayments,form:t,onChange:i=>{t.handleChange(i),w(i.target.value)}}),a.jsx("div",{children:a.jsxs("p",{className:"text-right text-sm",children:[j,"/100"]})}),j===100?a.jsx("p",{className:"text-sm text-red-500",children:"Max character limit of 100 reached."}):""]})]})]}),a.jsx("div",{className:"mt-1",children:a.jsx("button",{className:"btn-primary px-4 py-2",type:"submit",disabled:t.isSubmitting,children:"Submit"})})]})})})]})}export{ne as default};
