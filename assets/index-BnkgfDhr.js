import{r as a,b as E,k as I,H,j as e,A as L}from"./index-CR2PTnGP.js";import{B as Y}from"./BackBtn-qMQnlAqP.js";import{H as Z}from"./Heading-BGYpxq2W.js";import{h as l}from"./moment-C5S46NFB.js";import{P as q}from"./index-JjVOQ-Uu.js";import{T as R,a as U,b as v,c as o,d as V,e as c}from"./Tr-Cwkp4QFl.js";import{P as _}from"./plus-icon-Cm0htiCt.js";import{u as $}from"./useQuery-BvaY5-TG.js";import{L as z}from"./useWindowSize-Do2-NPva.js";import{D as K}from"./DisplayError-DwBfIbvM.js";import{I as Q}from"./ItemNotFound-BOlywaMD.js";import"./LoadingBtn-BtdHQEGi.js";import"./ClipLoader-BVQCHCPU.js";function le(){const[n,w]=a.useState([]),[i,D]=a.useState(1),[T,S]=a.useState(1),f=10,[t,g]=a.useState(""),[r,k]=a.useState(""),[d,A]=a.useState(""),[p,x]=a.useState(""),j=E(),F=["fetch-miningHistory",{currentPage:i,limit:f,backendFromDate:d,backendToDate:p}],{isLoading:M,data:m,isError:P,error:u}=$({queryKey:F,queryFn:()=>{const s=new URLSearchParams;return s.append("page",i),s.append("pageSize",f),s.append("sortBy","createdAt_ascending"),d&&s.append("from",d),p&&s.append("to",p),L.get(`/mining-history?${s.toString()}`)}});a.useEffect(()=>{if(m){const{data:{data:{docs:s,pages:h}}}=m;w(s),S(h)}u&&I.error(H(u))},[m,u]),a.useEffect(()=>{if(t&&r){if(l(r).isSame(t)||l(r).isBefore(t))return x("2025-01-11T23:59:59.999Z");if(l(t).isAfter(r))return g("2025-01-11T23:59:59.999Z");A(t),x(r)}},[t,r]);const C=()=>{j("/app/minings/add-mining-levels")},B=s=>{j(`/app/minings/details/${s}`)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Z,{title:"MC Minings"}),e.jsx(Y,{})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400",children:"Add"})}),e.jsxs("div",{className:"flex justify-between max-[400px]:flex-col gap-5",children:[e.jsxs("div",{className:"form-row",children:[e.jsx("label",{htmlFor:"fromDate",children:"From Date"}),e.jsx("input",{type:"date",id:"fromDate",placeholder:"Select Date",onChange:s=>{g(s.target.value)},value:t})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{htmlFor:"toDate",children:"To Date"}),e.jsx("input",{type:"date",id:"toDate",placeholder:"Select Date",onChange:s=>{k(s.target.value)},value:r})]})]}),e.jsx("section",{children:M?e.jsx(z,{}):P?e.jsx(K,{}):(n==null?void 0:n.length)===0?e.jsx(Q,{}):e.jsx("div",{className:"bg-secondary rounded-lg p-2 overflow-x-auto",children:e.jsxs("div",{className:"bg-dark  p-2 rounded-lg overflow-container  custom-scrollbar",children:[e.jsxs(R,{className:"sm:text-base text-sm table-auto  ",children:[e.jsx(U,{className:"bg-secondary text-left rounded-lg",children:e.jsxs(v,{children:[e.jsx(o,{scope:"col",className:" font-medium px-6 py-4 text-center",children:"Sr"}),e.jsx(o,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Username"}),e.jsx(o,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Mine Coins"}),e.jsx(o,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Date & Time"}),e.jsx(o,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Action"})]})}),e.jsx(V,{children:n==null?void 0:n.map((s,h)=>{var y,b,N;return e.jsxs(v,{className:"text-grayText sm:hover:bg-stroke hover:text-pure border-b border-b-gray-700",children:[e.jsx(c,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:(s==null?void 0:s.longAutoIncrementId)||(s==null?void 0:s.autoIncrementId)}),e.jsx(c,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:((y=s==null?void 0:s.user)==null?void 0:y.username)||((b=s==null?void 0:s.user)==null?void 0:b.fullName)}),e.jsx(c,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("span",{children:e.jsx("img",{src:_,alt:"coins icon",width:"16",height:"16"})}),e.jsx("span",{children:((N=s==null?void 0:s.minedCoins)==null?void 0:N.toFixed(2))||0})]})}),e.jsx(c,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:l((s==null?void 0:s.createdAt)||"2025-01-01").format("D, MMMM YYYY, hh:mm A")}),e.jsx(c,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:e.jsx("span",{className:"inline-flex items-center gap-2",children:e.jsx("button",{className:"text-blue-500",title:"View",onClick:()=>B(s==null?void 0:s._id),children:e.jsx("i",{className:"uil uil-eye text-xl  "})})})})]},h)})})]}),e.jsx(q,{totalPages:T,currentPage:i,setCurrentPage:D})]})})})]})})}export{le as default};
