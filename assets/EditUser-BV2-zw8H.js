import{u as U,r as i,j as s,A as T,k as y}from"./index-DXC4WxTY.js";import{F as k,a as A,b as $}from"./formik.esm-Nvf0k5vm.js";import{F as o}from"./FormControl-Vzz3kAOj.js";import{c as N,a as r,Y as O}from"./index.esm-BrFfqCuP.js";import{C as z}from"./ClipLoader-BeN6fJ0f.js";import{H}from"./Heading-BW07qGLk.js";import{B as I}from"./BackBtn-CAoFsR9d.js";import{L as V}from"./LoadingBtn-BPpN-Rmz.js";import{g as Y,S as K}from"./index-BnGhGuk-.js";import{Y as W}from"./index-B3uJ1EGy.js";import"./Input-C-gD7-3x.js";import"./react-tooltip.min-DX0qBXNw.js";import"./index-LvzHWtTh.js";import"./index-Chjiymov.js";const G=()=>{var w,j,v,d,h,C,g,q,R,S,E,P,a,p,c;const{id:m}=U(),[e,F]=i.useState([]),[D,f]=i.useState(!1);i.useEffect(()=>{(async()=>{var u;try{const{data:n}=await T.get(`/user/commission-rate/${m}`),{data:{doc:l}}=n;l&&((u=Object.keys(l))==null?void 0:u.length)>0&&F(l),f(!1)}catch(n){const{response:{data:{data:{message:l}}}}=n;y.error(l)}})()},[m,D]);const x=N().shape({tradeDepositBonus:r().required("Required"),autoTradeDailyProfitRate:r().required("Required"),autoTradeDepositBonus:r().required("Required"),tradeCommissions:N().shape({level1:r().required("Required"),level2:r().required("Required"),level3:r().required("Required")}),autoTradeCommissions:N().shape({level1:r().required("Required"),level2:r().required("Required"),level3:r().required("Required")})}),b={tradeDepositBonus:((w=e==null?void 0:e.tradeDepositBonus)==null?void 0:w.toFixed(2))||"",tradeCommissions:{level1:((v=(j=e==null?void 0:e.tradeCommissions)==null?void 0:j.level1)==null?void 0:v.toFixed(2))||"",level2:((h=(d=e==null?void 0:e.tradeCommissions)==null?void 0:d.level2)==null?void 0:h.toFixed(2))||"",level3:((g=(C=e==null?void 0:e.tradeCommissions)==null?void 0:C.level3)==null?void 0:g.toFixed(2))||""},autoTradeDailyProfitRate:((q=e==null?void 0:e.autoTradeDailyProfitRate)==null?void 0:q.toFixed(2))||"",autoTradeDepositBonus:((R=e==null?void 0:e.autoTradeDepositBonus)==null?void 0:R.toFixed(2))||"",autoTradeCommissions:{level1:((E=(S=e==null?void 0:e.autoTradeCommissions)==null?void 0:S.level1)==null?void 0:E.toFixed(2))||"",level2:((a=(P=e==null?void 0:e.autoTradeCommissions)==null?void 0:P.level2)==null?void 0:a.toFixed(2))||"",level3:((c=(p=e==null?void 0:e.autoTradeCommissions)==null?void 0:p.level3)==null?void 0:c.toFixed(2))||""}},L=async(t,{setSubmitting:u})=>{const n={...t,userObjectId:m};try{u(!0);const{data:l}=await T.post("/user/commission-rate",n);if(l!=null&&l.success){const{data:{message:B}}=l;y.success(B),f(!0)}}catch(l){const{response:{data:{message:B}}}=l;y.error(B)}finally{u(!1)}};return s.jsx("div",{children:s.jsx(k,{initialValues:b,validationSchema:x,onSubmit:L,enableReinitialize:!0,children:t=>s.jsxs(A,{className:"flex flex-col gap-4",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Trade Deposit Commission"}),s.jsxs("div",{className:"bg-dark p-4 rounded-lg",children:[s.jsxs("div",{className:"flex md:flex-row flex-col gap-4",children:[s.jsx(o,{control:"input",type:"number",label:"Trade Deposit Bonus %",name:"tradeDepositBonus",placeholder:"Ex : 4%",formik:t}),s.jsx(o,{control:"input",type:"number",label:"Level One Startup Commision %",name:"tradeCommissions.level1",placeholder:"Ex : 5%",formik:t})]}),s.jsxs("div",{className:"flex md:flex-row flex-col gap-4 mt-4",children:[s.jsx(o,{control:"input",type:"number",label:"Level Two Startup Commision %",name:"tradeCommissions.level2",placeholder:"Ex : 4%",formik:t}),s.jsx(o,{control:"input",type:"number",label:"Level Three Startup Commision %",name:"tradeCommissions.level3",placeholder:"Ex : 3%",formik:t})]})]}),s.jsx("h2",{className:"text-xl font-bold",children:"Auto Trade Profit Share"}),s.jsxs("div",{className:"bg-dark p-4 rounded-lg",children:[s.jsxs("div",{className:"flex md:flex-row flex-col gap-4",children:[s.jsx(o,{control:"input",type:"number",label:"Auto Trade Deposit Bonus %",name:"autoTradeDepositBonus",placeholder:"Ex : 4%",formik:t}),s.jsx(o,{control:"input",type:"number",label:"Level One Residual Commision %",name:"autoTradeCommissions.level1",placeholder:"Ex : 5%",formik:t})]}),s.jsxs("div",{className:"flex md:flex-row flex-col gap-4 mt-4",children:[s.jsx(o,{control:"input",type:"number",label:"Level Two Residual Commision %",name:"autoTradeCommissions.level2",placeholder:"Ex : 4%",formik:t}),s.jsx(o,{control:"input",type:"number",label:"Level Three Residual Commision %",name:"autoTradeCommissions.level3",placeholder:"Ex : 3%",formik:t})]}),s.jsx("div",{className:"flex md:flex-row flex-col gap-4 mt-4",children:s.jsx(o,{control:"input",type:"number",label:"Auto Trade Daily Profit Rate (%)",name:"autoTradeDailyProfitRate",placeholder:"Ex : 4%",formik:t})})]}),s.jsx("div",{className:"mt-6",children:s.jsx("button",{type:"submit",className:"btn-primary py-3 px-12",disabled:t.isSubmitting,children:t.isSubmitting?s.jsx(z,{size:20,color:"white"}):"Save"})})]})})})};W(O);const J=N().shape({fullName:r().required("Full Name is required."),username:r().required("Username is required."),email:r().email().required(),phone:r().required("Phone number is required."),password:r().password().required(),confirmPassword:r().required("Confirm Password."),referrer:r().required("Referrer is required.")}),M=N().shape({fullName:r().required("Full Name is required."),username:r().required("Username is required."),email:r().email().required(),phone:r().required("Phone number is required."),password:r().password().required(),confirmPassword:r().required("Confirm Password."),referrer:r().required("Referrer is required."),blockReason:r().required("Required")}),ce=()=>{const{id:m}=U(),[e,F]=i.useState([]),[D,f]=i.useState(!1),[x,b]=i.useState("PAK"),w=new Intl.DisplayNames(["en"],{type:"region"}).of(Y(x||"PAK")),[j,v]=i.useState(""),[d,h]=i.useState(""),[C,g]=i.useState(!1),q=a=>{b(a.target.value)};i.useEffect(()=>{e!=null&&e.countryCode&&b(e==null?void 0:e.countryCode)},[e]),i.useEffect(()=>{(async()=>{var p;try{const{data:c}=await T.get(`/user/${m}`),{data:{doc:t},data:{doc:{status:u}}}=c;t&&((p=Object.keys(t))==null?void 0:p.length)>0&&(F(t),h(u),b(t==null?void 0:t.countryCode)),g(!1)}catch(c){console.error(c)}})()},[m,C]),i.useEffect(()=>{document.getElementById("select-country").addEventListener("change",()=>{v("")})},[]);const R=async(a,{resetForm:p,setFieldError:c,setSubmitting:t})=>{if(a.confirmPassword!==a.password)return c("confirmPassword","Passwords does not match.");if(!x)return v("Select Country.");if(a.status==="blocked"&&!a.blockReason)return c("blockReason","Required.");const u={...a,countryName:w,countryCode:x};f(!0);try{const{data:n}=await T.patch(`/user/${m}`,u);if(n!=null&&n.success){const{data:{message:l}}=n;y.success(l),g(!0)}}catch(n){const{response:{data:{message:l}}}=n;y.error(l)}finally{f(!1),t(!1),p()}},S=a=>{a.target.checked?h("blocked"):h("active")},E={fullName:(e==null?void 0:e.fullName)||"",username:(e==null?void 0:e.username)||"",email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||"",password:"",confirmPassword:"",referrer:(e==null?void 0:e.referrer)||"",status:"active",blockReason:""},P={fullName:(e==null?void 0:e.fullName)||"",username:(e==null?void 0:e.username)||"",email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||"",password:"",confirmPassword:"",referrer:(e==null?void 0:e.referrer)||"",status:"blocked",blockReason:(e==null?void 0:e.blockReason)||""};return s.jsxs("div",{className:"overflow-auto",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(H,{title:"Edit User",icon:"pen-alt"}),s.jsx(I,{})]}),s.jsx("div",{className:"bg-dark rounded-lg p-4 mt-6",children:s.jsx(k,{initialValues:d==="active"?E:P,validationSchema:d==="active"?J:M,onSubmit:R,enableReinitialize:!0,children:a=>s.jsxs(A,{className:"flex flex-col gap-6",children:[s.jsxs("div",{className:"flex gap-4 sm:flex-row flex-col",children:[s.jsx(o,{label:"Full Name",control:"input",placeholder:"Enter Full Name",name:"fullName",formik:a}),s.jsx(o,{label:"Username",control:"input",placeholder:"Enter username",name:"username",formik:a})]}),s.jsxs("div",{className:"flex gap-4 sm:flex-row flex-col",children:[s.jsx(o,{label:"Email",control:"input",placeholder:"Enter Email",name:"email",formik:a}),s.jsx(o,{label:"Phone",control:"phone",placeholder:"Enter Phone Number",name:"phone",formik:a})]}),s.jsxs("div",{className:"flex gap-4 sm:flex-row flex-col",children:[s.jsxs("div",{className:"w-full flex flex-col gap-2",children:[s.jsx("label",{htmlFor:"select-country",className:"text-inherit font-bold",children:"Select Country"}),s.jsx(K,{className:"w-full border border-gray-700 rounded-md bg-inherit px-[14px] py-[11px]",value:x,onChange:q,id:"select-country"}),j&&s.jsx("p",{className:"text-red-600",children:j})]}),s.jsx("div",{className:"w-full",children:s.jsx(o,{label:"Referrer",control:"input",placeholder:"Enter Referrer",name:"referrer",formik:a})})]}),s.jsxs("div",{className:"flex gap-4 sm:flex-row flex-col",children:[s.jsx(o,{label:"Password",control:"password",placeholder:"Enter password",name:"password",formik:a}),s.jsx(o,{label:"Confirm Password",control:"password",placeholder:"Confirm Password",name:"confirmPassword",formik:a})]}),s.jsxs("div",{className:" flex flex-col gap-6",children:[s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("label",{className:"text-lg font-bold inline-flex items-center gap-2",children:[s.jsx("span",{children:"Status"}),s.jsxs("span",{className:`${d==="active"?"text-green-500":"text-red-500"} capitalize inline-block font-medium text-sm`,children:["( ",d," )"]})]}),s.jsx("input",{className:"status-input",type:"checkbox",id:"status",name:"status",value:d,form:a,checked:d==="blocked",onChange:S,hidden:!0}),s.jsx("label",{htmlFor:"status",className:"status-toggle","aria-label":"Toggle Button"})]}),d==="blocked"&&s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("label",{className:"text-md font-bold",htmlFor:"blockReason",children:"Block Reason"}),s.jsx($,{className:`${a.errors.blockReason&&a.touched.blockReason?"border-red-500 focus:border-red-500":""} text-inherit bg-inherit border border-gray-700 outline-none rounded-md px-[13px] py-[12px] focus:border-blue-500`,type:"text",name:"blockReason",id:"blockReason",form:a,onChange:a.handleChange}),a.errors.blockReason&&a.touched.blockReason?s.jsx("div",{className:"text-red-500 text-sm",children:a.errors.blockReason}):null]})]}),s.jsx("div",{className:"mt-2 mb-4",children:s.jsx("button",{type:"submit",className:"btn-primary py-3 px-10",disabled:a.isSubmitting,children:D?s.jsx(V,{}):"Update"})})]})})}),s.jsx("div",{className:"mt-6",children:s.jsx("div",{className:"rounded-lg mt-2",children:s.jsx(G,{})})})]})};export{ce as default};
