import{b as $,r as x,a as P,j as e,L as k,a4 as Y,c as z,k as H,A as M}from"./index-B-9Gm_Me.js";import{h as v}from"./moment-C5S46NFB.js";import{M as C}from"./react-tooltip.min-BA7Ht3Ge.js";import{T as q,a as R,b as A,c as i,d as Z,e as p}from"./Tr-OYvCsoa0.js";import{P as U}from"./index-D0YzV_-V.js";import{c as V}from"./confirmBox-m9conJ9D.js";import{S as K}from"./Status-BqG-bA88.js";import{w as Q,g as G}from"./withdrawActions-DqOoRdk0.js";import{C as J}from"./ClipLoader-BG20_dJY.js";import{B as O}from"./BackBtn-uUxpUHCb.js";import{D as X}from"./DisplayError-C9QH4sGL.js";import{H as ee}from"./Heading-CR7EINQw.js";import{I as se}from"./ItemNotFound-DC3tQxqN.js";import{L as ae}from"./useWindowSize-qltt3n4q.js";import{u as te}from"./useQuery-CC_glNBa.js";import"./index-LvzHWtTh.js";import"./index-Chjiymov.js";import"./LoadingBtn-BzFN3F6Y.js";const re=({docs:c,pages:o,currentPage:y,setCurrentPage:n,updateLoading:b,startIndex:u})=>{const N=$(),[w,g]=x.useState(null),h=P(),D=async(s,l)=>{s.stopPropagation(),g(l);const d={status:"Approved"};V({message:"Are you sure you want to approve this withdrawal?",onYesClick:async()=>{try{h(Q(l,d)),N("/app/withdrawals/Approved"),window.location.reload()}catch(j){console.error("Error updating withdrawal:",j)}}})};return e.jsx("div",{className:"bg-secondary rounded-lg p-2 overflow-x-auto",children:e.jsxs("div",{className:"bg-dark p-2 rounded-lg overflow-container custom-scrollbar",children:[e.jsxs(q,{className:"sm:text-base text-sm table-auto",children:[e.jsx(R,{className:"bg-secondary text-left rounded-lg",children:e.jsxs(A,{children:[e.jsx(i,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Sr"}),e.jsx(i,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"User"}),e.jsx(i,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Withdraw Coins"}),e.jsx(i,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Service Charges"}),e.jsx(i,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Withdraw Wallet"}),e.jsx(i,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Date"}),e.jsx(i,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Status"}),e.jsx(i,{scope:"col",className:"font-medium px-6 py-4 text-center",children:"Actions"})]})}),e.jsx(Z,{children:c==null?void 0:c.map((s,l)=>{var d,m,f,j;return e.jsxs(A,{className:`text-grayText sm:hover:bg-stroke hover:text-pure ${l===(c==null?void 0:c.length)-1?"":"border-b border-b-gray-700"}`,onClick:()=>{var r;return N(`/app/users/details/${(r=s==null?void 0:s.user)==null?void 0:r._id}`)},children:[e.jsx(p,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:s!=null&&s.longAutoIncrementId?s==null?void 0:s.longAutoIncrementId:u+l+1?u+l+1:"N/A"}),e.jsx(p,{className:"py-4 px-6 whitespace-nowrap sm:text-center",children:e.jsx(k,{to:`/app/users/details/${(d=s==null?void 0:s.user)==null?void 0:d._id}`,children:(m=s==null?void 0:s.user)==null?void 0:m.username})}),e.jsx(p,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:s==null?void 0:s.coinsToWithdraw}),e.jsx(p,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:s==null?void 0:s.serviceCharges}),e.jsx(p,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:e.jsx("div",{className:"flex flex-col gap-1",children:e.jsx("span",{children:(j=(f=s==null?void 0:s.wallet)==null?void 0:f.type)==null?void 0:j.replace("_"," ")})})}),e.jsx(p,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:v(s.createdAt).format("DD MMM YYYY hh:mm A")}),e.jsx(p,{className:"px-6 py-4 whitespace-nowrap sm:text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(K,{status:s==null?void 0:s.status})})}),e.jsx(p,{className:"px-6 py-4 whitespace-nowrap sm:text-center ",children:e.jsx("div",{className:"flex justify-center items-center gap-4 text-xl",children:s.status==="Pending"?b&&(s==null?void 0:s._id)===w?e.jsx(J,{size:20,color:"white"}):e.jsxs(e.Fragment,{children:[e.jsxs(k,{to:`/app/withdrawals/details/${s._id}`,className:"text-primary","data-tooltip-id":"view-user-details","data-tooltip-content":"View Details",onClick:r=>r.stopPropagation(),children:[e.jsx("i",{className:"uil uil-eye"}),e.jsx(C,{id:"view-user-details",style:{fontSize:15}})]}),e.jsxs("button",{className:"text-green-500","data-tooltip-id":"approve-deposit","data-tooltip-content":"Approve Request",onClick:r=>D(r,s._id),children:[e.jsx("i",{className:"uil uil-check"}),e.jsx(C,{id:"approve-deposit",style:{fontSize:15}})]})]}):s.status==="Approved"?e.jsxs(k,{to:`/app/withdrawals/details/${s._id}`,className:"text-primary","data-tooltip-id":"view-user-details","data-tooltip-content":"View Details",onClick:r=>r.stopPropagation(),children:[e.jsx("i",{className:"uil uil-eye"}),e.jsx(C,{id:"view-user-details",style:{fontSize:15}})]}):s.status==="Declined"?e.jsx("span",{children:"--------"}):null})})]},s==null?void 0:s._id)})})]}),e.jsx("div",{className:"py-4 text-center",children:e.jsx(U,{totalPages:o,currentPage:y,setCurrentPage:n})})]})})},be=()=>{const c=Y(),[o,y]=x.useState(""),[n,b]=x.useState(""),[u,N]=x.useState(""),[w,g]=x.useState(""),[h,D]=x.useState(1),s=10,l=(h-1)*10,d=c.pathname.split("/").pop(),m=P(),{docs:f,docsCount:j,pages:r,updateLoading:_}=z(a=>a.withdraw);x.useEffect(()=>{if(o&&n){if(v(n).isSame(o)||v(n).isBefore(o))return g("2025-01-11T23:59:59.999Z");if(v(o).isAfter(n))return y("2025-01-11T23:59:59.999Z");N(o),g(n)}},[o,n]);const F=["fetch-all-withdrawals",d,u,w,s,h],{isLoading:I,data:S,isError:L,error:t}=te({queryKey:F,queryFn:()=>{const a=new URLSearchParams;return a.append("page",h),a.append("pageSize",s),a.append("status",d),u&&a.append("from",u),w&&a.append("to",w),M.get(`/withdraw?${a.toString()}`)}});return x.useEffect(()=>{var a,T;if(S){const{data:{data:{docs:W,docsCount:B,pages:E}}}=S;m(G(W,B,E))}t&&H.error(t!=null&&t.message?t==null?void 0:t.message:(T=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:T.message)},[S,m,t]),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx(ee,{title:"Withdrawals"}),e.jsx(O,{})]}),e.jsxs("div",{className:"flex justify-between max-[400px]:flex-col gap-5 mt-6",children:[e.jsxs("div",{className:"form-row",children:[e.jsx("label",{htmlFor:"fromDate",children:"From Date"}),e.jsx("input",{type:"date",id:"fromDate",name:"from",value:o,onChange:a=>{y(a.target.value)}})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{htmlFor:"toDate",children:"To Date"}),e.jsx("input",{type:"date",id:"toDate",name:"to",value:n,onChange:a=>{b(a.target.value)}})]})]}),e.jsx("div",{className:"mt-6 w-full",children:I?e.jsx(ae,{}):L?e.jsx(X,{message:"An error occurred in withdrawals"}):f.length===0?e.jsx(se,{message:`No ${d} withdrawals found.`}):e.jsx(re,{docs:f,docsCount:j,pages:r,currentPage:h,setCurrentPage:D,updateLoading:_,startIndex:l})})]})};export{be as default};
