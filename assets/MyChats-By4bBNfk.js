import{T as $,r as c,b as C,a as E,j as e,d as L,L as P,$ as U,k as _,A as D}from"./index-CR2PTnGP.js";import{u as A}from"./useQuery-BvaY5-TG.js";import{I as B}from"./img1-CxsS-zk5.js";import{P as F}from"./index-JjVOQ-Uu.js";import{B as q}from"./BackBtn-qMQnlAqP.js";import{D as z}from"./DisplayError-DwBfIbvM.js";import{H}from"./Heading-BGYpxq2W.js";import{L as M}from"./useWindowSize-Do2-NPva.js";import{I as R}from"./ItemNotFound-BOlywaMD.js";import"./LoadingBtn-BtdHQEGi.js";import"./ClipLoader-BVQCHCPU.js";const T=({docs:n,currentPage:i,setCurrentPage:t,pages:N})=>{const o=$(),f=o==null?void 0:o.username,[x,b]=c.useState([]),g=C(),y=E();c.useEffect(()=>{if((n==null?void 0:n.length)>0){const a=n==null?void 0:n.map(r=>{var s;return{...r,users:(s=r==null?void 0:r.users)==null?void 0:s.filter(l=>(l==null?void 0:l.username)!==f)}}).filter(r=>{var s;return((s=r==null?void 0:r.users)==null?void 0:s.length)>0});b(a)}},[n,f]);const w=(a,r)=>{g(`/app/support/${a}`),y(U(r))};return e.jsx("div",{className:"flex flex-col space-y-4 w-full mt-6",children:e.jsxs("div",{className:"flex flex-col w-full bg-dark rounded-lg p-4",children:[x==null?void 0:x.map(a=>{var r,s,l,u,d,p,h,j,v,S,k;return e.jsxs("div",{className:`${((r=a==null?void 0:a.users[0])==null?void 0:r.status)==="deleted"?"hidden":""} flex flex-row max-[600px]:flex-col gap-5 justify-between items-center text-grayText hover:bg-stroke hover:text-pure border-b border-b-gray-700 py-4 px-3 cursor-pointer `,children:[e.jsxs("div",{className:"flex flex-row items-center max-[600px]:w-full gap-3",children:[e.jsx("div",{children:e.jsx("img",{src:(s=a==null?void 0:a.users[0])!=null&&s.image?L+"/"+((l=a==null?void 0:a.users[0])==null?void 0:l.image):B,className:"w-[50px] h-[50px] rounded-full object-cover",alt:(u=a==null?void 0:a.users[0])!=null&&u.fullName?(d=a==null?void 0:a.users[0])==null?void 0:d.fullName:(p=a==null?void 0:a.users[0])==null?void 0:p.username})}),e.jsxs("div",{className:"flex flex-col space-y-1 text-md",children:[e.jsx("div",{className:"underline",children:e.jsx(P,{to:`/app/users/details/${(h=a==null?void 0:a.users[0])==null?void 0:h._id}`,children:e.jsx("p",{children:(j=a==null?void 0:a.users[0])!=null&&j.fullName?(v=a==null?void 0:a.users[0])==null?void 0:v.fullName:(S=a==null?void 0:a.users[0])==null?void 0:S.username})})}),e.jsx("div",{children:e.jsx("p",{children:(k=a==null?void 0:a.users[0])==null?void 0:k.email})})]})]}),e.jsx("div",{className:"px-3 max-[600px]:w-full max-[600px]:px-0 ",children:e.jsxs("button",{onClick:()=>{var I;return w(a==null?void 0:a._id,(I=a==null?void 0:a.users[0])==null?void 0:I._id)},className:"w-[160px] max-[600px]:w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400",children:[e.jsx("i",{className:"uil uil-comments text-white",style:{fontSize:"20px"}})," ","Start Chat"]})})]},a==null?void 0:a._id)}),e.jsx(F,{totalPages:N,currentPage:i,setCurrentPage:t})]})})},aa=()=>{const n=$(),{_id:i}=n,[t,N]=c.useState([]),[o,f]=c.useState(1),[x,b]=c.useState(1),g=10,y=["fetch-chat",{currentPage:o,limit:g}],{isLoading:w,data:a,isError:r,error:s}=A({queryKey:y,queryFn:()=>D.get(`/chat/?userObjectId=${i}&page=${o}&pageSize=${g}`)});return c.useEffect(()=>{var l,u,d,p;if(a){const{data:{data:{docs:h,pages:j}}}=a;N(h),b(j)}s&&_.error((u=(l=s==null?void 0:s.response)==null?void 0:l.data)!=null&&u.message?(p=(d=s==null?void 0:s.response)==null?void 0:d.data)==null?void 0:p.message:s==null?void 0:s.message)},[a,s]),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx(H,{title:"My Chats"}),e.jsx(q,{})]}),e.jsx("div",{className:"mt-6",children:w?e.jsx(M,{}):r?e.jsx(z,{message:"An error occurred while fetching users."}):(t==null?void 0:t.length)===0?e.jsx(R,{message:"No data found."}):e.jsx(T,{docs:t,currentPage:o,setCurrentPage:f,pages:x})})]})};export{aa as default};
