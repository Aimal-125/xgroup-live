import{u as $,r as n,j as a,A as x,k as v}from"./index-B-9Gm_Me.js";import{B as O}from"./BackBtn-uUxpUHCb.js";import{H as B}from"./Heading-CR7EINQw.js";import{g as M,S as H}from"./index-BEmnNwMs.js";import{F as K,a as _,b as q,E as h}from"./formik.esm-BbQy4037.js";import{F as i,S as z,U as L}from"./FormControl-CIKMnFb0.js";import{I as Y}from"./informationValidations-CbtxmjtR.js";import"./Input-Be9myPu5.js";import"./react-tooltip.min-BA7Ht3Ge.js";import"./index-LvzHWtTh.js";import"./index-Chjiymov.js";import"./index.esm-Bg4kD9Su.js";import"./index-CCBZLt8G.js";function le(){const{id:d}=$(),[l,C]=n.useState([]),[S,f]=n.useState(!1),[g,b]=n.useState(""),[m,w]=n.useState(""),[u,N]=n.useState("PAK"),E=new Intl.DisplayNames(["en"],{type:"region"}).of(M(u||"PAK")),[F,p]=n.useState([]),[P,A]=n.useState([]),D=e=>{N(e.target.value)},R={fullName:(l==null?void 0:l.fullName)||"",username:(l==null?void 0:l.username)||"",email:(l==null?void 0:l.email)||"",password:"",confirmPassword:"",roles:[],countryName:""},U=async(e,{setSubmitting:s,resetForm:o})=>{var t,y,j;if(!m)return b("Required");const c={...e,countryCode:u,countryName:E,phone:m};try{s(!0);const{data:r}=await x.patch(`/user/mrDoorbeen071567-employee-update/${d}`,c);r!=null&&r.success&&(v.success((t=r==null?void 0:r.data)==null?void 0:t.message),f(!0))}catch(r){r&&v.error((j=(y=r==null?void 0:r.response)==null?void 0:y.data)==null?void 0:j.message)}finally{s(!1),o()}};n.useEffect(()=>{(async()=>{try{const{data:s}=await x.get("/user/role");if(s&&s.data&&s.data.roles){const c=s.data.roles.filter(t=>t.name!=="user").map(t=>({value:t.name,label:t.name.charAt(0).toUpperCase()+t.name.slice(1).replace("_"," ")}));A(c)}else console.error("Invalid data structure from API")}catch(s){console.error("Error fetching roles:",s)}})()},[]),n.useEffect(()=>{(async()=>{const{data:s}=await x.get(`/user/${d}`),{data:{doc:o}}=s;C(o);const c=o==null?void 0:o.roles.map(t=>({value:t,label:t.charAt(0).toUpperCase()+t.slice(1).replace("_"," ")}));p(c),w(o==null?void 0:o.phone),N(o==null?void 0:o.countryCode),f(!1)})()},[d,S]);const V=(e,s)=>{const o=e?e.map(c=>c.value):[];p(e),s.setFieldValue("roles",o)},I={control:(e,s)=>({...e,border:"1px solid #4a5568",backgroundColor:"inherit",color:"white","&:hover":{border:"1px solid #4a5568"},boxShadow:s.isFocused?"0 0 0 1px #4a5568":null,borderRadius:"0.375rem"}),singleValue:e=>({...e,color:"white"}),multiValue:e=>({...e,backgroundColor:"#2d3748",color:"white"}),multiValueLabel:e=>({...e,color:"white"}),multiValueRemove:e=>({...e,color:"white","&:hover":{backgroundColor:"#4a5568",color:"white"}}),menu:e=>({...e,backgroundColor:"#1a202c",color:"white",border:"1px solid #4a5568"}),option:(e,s)=>({...e,backgroundColor:s.isFocused?"#2d3748":"#1a202c",color:"white","&:active":{backgroundColor:"#4a5568"}}),placeholder:e=>({...e,color:"gray"}),input:e=>({...e,color:"white",padding:"7px"})};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(B,{title:"Edit Employee"}),a.jsx(O,{})]}),a.jsx("div",{className:"bg-dark p-4 rounded-lg mt-6 pb-6",children:a.jsx(K,{initialValues:R,validationSchema:Y,onSubmit:U,enableReinitialize:!0,children:e=>a.jsxs(_,{className:"bg-dark rounded-lg p-4 flex flex-col gap-4 mt-6 pb-6",children:[a.jsxs("div",{className:"flex flex-row max-[600px]:flex-col max-[600px]:gap-4 gap-2",children:[a.jsx(i,{control:"input",label:"Full Name",placeholder:"Enter Full Name",name:"fullName",formik:e}),a.jsx(i,{control:"input",label:"User Name",placeholder:"Enter Username",name:"username",formik:e})]}),a.jsxs("div",{className:"flex flex-row max-[600px]:flex-col max-[600px]:gap-4 gap-2",children:[a.jsx(i,{control:"input",label:"Email",placeholder:"Enter Your Email",name:"email",formik:e}),a.jsx(i,{control:"password",label:"Password",placeholder:"Enter Password",name:"password",id:"password",formik:e})]}),a.jsxs("div",{className:"flex flex-row max-[600px]:flex-col max-[600px]:gap-4 gap-2",children:[a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsx("label",{className:"text-inherit font-bold bg-gr",htmlFor:"confirmPassword",children:"Confirm Password"}),a.jsx(q,{className:`${e.errors.confirmPassword&&e.touched.confirmPassword?"border-red-500":""} p-[11px] bg-dark rounded-md border border-gray-700 outline-none`,type:"password",name:"confirmPassword",id:"confirmPassword",placeholder:"Confirm Password"}),a.jsx(h,{name:"confirmPassword",component:"div",className:"text-sm text-red-500"})]}),a.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[a.jsx("label",{htmlFor:"roles",className:"text-inherit font-bold",children:"Select Role"}),a.jsx(z,{styles:I,value:F,name:"roles",form:e,options:P,onChange:s=>V(s,e),isMulti:!0,onFocus:()=>p("")}),a.jsx(h,{component:"div",name:"roles",className:"text-sm text-red-500"})]})]}),a.jsxs("div",{className:"flex justify-between gap-2 max-[600px]:flex-col max-[600px]:gap-4",children:[a.jsxs("div",{className:"w-full flex flex-col gap-2 overflow-auto",children:[a.jsx("label",{htmlFor:"phone",className:"text-inherit font-bold",children:"Phone"}),a.jsx(L,{className:"phone-input",defaultCountry:"pk",value:m,id:"phone",name:"phone",onChange:s=>{b(""),w(s)}}),g&&a.jsx("p",{className:"text-red-600",children:g})]}),a.jsxs("div",{className:"w-full flex flex-col gap-2",children:[a.jsx("label",{htmlFor:"select-country",className:"text-inherit font-bold",children:"Select Country"}),a.jsx(H,{className:`${e.errors.countryName&&e.touched.countryName?"border-red-500":""} w-full border border-gray-700 rounded-md bg-inherit px-[14px] py-[11px]`,value:u,onChange:s=>{e.handleChange(s),D(s)},name:"countryName",id:"countryName",form:e}),a.jsx(h,{name:"countryName",component:"div",className:"text-sm text-red-500"})]})]}),a.jsx("div",{className:"mt-4",children:a.jsx("button",{type:"submit",className:"btn-primary py-2 px-12",disabled:e==null?void 0:e.isSubmitting,children:"Submit"})})]})})})]})}export{le as default};
